// Generated by CoffeeScript 1.6.2
(function() {
  var TagApp;

  TagApp = window.TagApp || (window.TagApp = {});

  TagApp.Main = {
    init: function() {
      _.bindAll(this);
      return $('.js-get-location').on('click', this.getLocation);
    },
    getLocation: function(e) {
      e.preventDefault();
      return navigator.geolocation.getCurrentPosition(this.haveLocation);
    },
    haveLocation: function(position) {
      var image, tag;

      this.showResult(position);
      return;
      tag = "#geo:lat/long:" + position.coords.latitude + "/" + position.coords.longitude;
      console.log(tag);
      image = "http://maps.googleapis.com/maps/api/staticmap?center=" + position.coords.latitude + "," + position.coords.longitude + "&zoom=12&size=400x400&sensor=false&&maptype=roadmap&visual_refresh=true&style=feature:road|visibility:simplified&style=feature:landscape|visibility:on&style=feature:poi|visibility:off";
      return $("body").append("<img src=\"" + image + "\" />");
    },
    resultView: Backbone.View.extend({
      className: 'result',
      initialize: function() {
        console.log(this.model.toJSON());
        return this.render();
      },
      template: _.template("<div class=\"map\" style=\"background-image: url('http://maps.googleapis.com/maps/api/staticmap?center=<%= coords.latitude %>,<%= coords.longitude %>&zoom=12&size=400x400&sensor=false&&maptype=roadmap&visual_refresh=true&style=feature:road|visibility:simplified&style=feature:landscape|visibility:on&style=feature:poi|visibility:off');\">\n</div>\n<input type=\"text\" class=\"js-tag\" value=\"#lat/long/zoom:<%= coords.latitude %>/<%= coords.longitude %>\"></input>"),
      render: function() {
        var _this = this;

        this.$el.html(this.template(this.model.toJSON()));
        return _.defer(function() {
          return _this.$('.js-tag').focus();
        });
      }
    }),
    showResult: function(position) {
      var view;

      $('.js-intro').addClass('hide');
      view = new this.resultView({
        model: new Backbone.Model(position)
      });
      return $('#app').append(view.el);
    }
  };

}).call(this);
